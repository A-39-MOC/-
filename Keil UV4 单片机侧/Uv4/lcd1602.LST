C51 COMPILER V9.56.0.0   LCD1602                                                           12/16/2024 19:35:41 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE LCD1602
OBJECT MODULE PLACED IN lcd1602.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE lcd1602.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include <reg52.h>
   2          #include "delay.h"
   3          #include "lcd1602.h"
   4          
   5          /*******************************************************************************
   6          * 函 数 名         : lcd1602WriteCmd
   7          * 函数功能       : 向LCD写入一个字节的命令
   8          * 输    入         : uchar cmd
   9          * 输    出         : void
  10          *******************************************************************************/
  11          void lcd1602WriteCmd(uchar cmd) //写入命令
  12          {
  13   1        LCD1602_E = 0;          //使能
  14   1        LCD1602_RS = 0;         //选择发送命令
  15   1        LCD1602_RW = 0;         //选择写入
  16   1        LCD1602_DATAPINS = cmd;     //放入命令
  17   1        delay_us(100);
  18   1      
  19   1        LCD1602_E = 1;              //写入时序
  20   1        delay_us(100);
  21   1        LCD1602_E = 0;
  22   1        delay_ms(5);        //写完一个字节延时等待5ms，否则下次写入时LCD忙警告
  23   1      }
  24          
  25          /*******************************************************************************
  26          * 函 数 名         : LcdWriteData
  27          * 函数功能       : 向LCD写入一个字节的数据
  28          * 输    入         : uchar dat
  29          * 输    出         : void
  30          *******************************************************************************/             
  31          void lcd1602WriteData(uchar dat)  //写入数据
  32          {
  33   1        LCD1602_E = 0;          //使能清零
  34   1        LCD1602_RS = 1;         //选择输入数据
  35   1        LCD1602_RW = 0;         //选择写入
  36   1        LCD1602_DATAPINS = dat;     //写入数据
  37   1        delay_us(100);
  38   1      
  39   1        LCD1602_E = 1;          //写入时序
  40   1        delay_us(100);
  41   1        LCD1602_E = 0;
  42   1        delay_ms(5);          //写完一个字节延时等待5ms，否则下次写入时LCD忙警告
  43   1      }
  44          
  45          /*******************************************************************************
  46          * 函 数 名       : lcd1602_init()
  47          * 函数功能     : 初始化LCD屏
  48          * 输    入       : void
  49          * 输    出       : void
  50          *******************************************************************************/       
  51          void lcd1602_init(void)   //LCD初始化
  52          {
  53   1        lcd1602WriteCmd(0x38);  //开显示
  54   1        lcd1602WriteCmd(0x0c);  //开显示不显示光标
  55   1        lcd1602WriteCmd(0x06);  //写一个指针加1
C51 COMPILER V9.56.0.0   LCD1602                                                           12/16/2024 19:35:41 PAGE 2   

  56   1        lcd1602_clear();    //清除显示
  57   1      }
  58          
  59          /*******************************************************************************
  60          * 函 数 名       : lcd1602_clear()
  61          * 函数功能     : 清空LCD屏
  62          * 输    入       : 无
  63          * 输    出       : 无
  64          *******************************************************************************/       
  65          void lcd1602_clear(void)  //LCD清屏
  66          {
  67   1        lcd1602WriteCmd(0x01);  //清屏
  68   1        lcd1602WriteCmd(0x80);  //设置数据指针起点
  69   1      }
  70          
  71          /*******************************************************************************
  72          * 函 数 名       : lcd1602_write_str
  73          * 函数功能     : 将数组内容显示到屏幕
  74          * 输    入       : uchar *str, bit x, uchar y
  75          * 输    出       : void
  76          *******************************************************************************/
  77          void lcd1602_write_str(uchar *str, bit x, uchar y)
  78          {
  79   1        uchar address = 0x80;   //默认显示地址
  80   1        if(x)           //如果写入第2行
  81   1        {
  82   2          address += 0x40;    //写入地址+0x40
  83   2        }
  84   1        address += y;       //定位到显示位置
  85   1        lcd1602WriteCmd(address); //设置写入指针位置
  86   1        while(*str)           //判断字符是否显示完
  87   1        {
  88   2          lcd1602WriteData(*str++);//显示字符
  89   2        }
  90   1      }
  91          
  92          /*******************************************************************************
  93          * 函 数 名       : show_cursor
  94          * 函数功能     : 显示光标位置
  95          * 输    入       : bit x, uchar y
  96          * 输    出       : void
  97          *******************************************************************************/
  98          void show_cursor(bit x, uchar y)
  99          {
 100   1        uchar address = 0x80;   //默认显示地址
 101   1        if(x)           //如果写入第2行
 102   1        {
 103   2          address += 0x40;    //写入地址+0x40
 104   2        }
 105   1        address += y;       //定位到显示位置
 106   1        lcd1602WriteCmd(address); //写入显示位置
 107   1        lcd1602WriteCmd(0x0f);    //光标闪烁
 108   1      }
 109          
 110          /*******************************************************************************
 111          * 函 数 名       : hide_cursor
 112          * 函数功能     : 隐藏光标
 113          * 输    入       : void
 114          * 输    出       : void
 115          *******************************************************************************/
 116          void hide_cursor(void)
 117          {
C51 COMPILER V9.56.0.0   LCD1602                                                           12/16/2024 19:35:41 PAGE 3   

 118   1        lcd1602WriteCmd(0x0c);    //隐藏光标
 119   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    161    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       2
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
